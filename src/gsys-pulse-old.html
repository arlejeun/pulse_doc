<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-subheader/paper-subheader.html">
<link rel="import" href="../bower_components/poly-filter/poly-filter.html">
<link rel="import" href="../bower_components/iron-grid/iron-grid.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">

<!--<link rel="import" href="../bower_components/poly-filter/demo/demo-list.html">-->
<link rel="import" href="gsys-pulse-templates.html">
<link rel="import" href="gsys-pulse-dashboards.html">
<link rel="import" href="market-category-data.html">
<link rel="import" href="shared-styles.html">

<dom-module id="gsys-pulse">

  <template>

    <style include="shared-styles">
      :host {
        display: block;
        padding: 10px;
      }

    </style>


    <!--
      app-route provides the name of the category.
    -->
    <app-route
        route="[[route]]"
        pattern="/:category"
        data="{{routeData}}"
        tail="{{subroute}}">
    </app-route>


    <div class="card">
      <div class="circle">1</div>
      <h1>View One [[routeData.category]]</h1>
      <p>Ut labores minimum atomorum pro. Laudem tibique ut has.</p>
    </div>

    <iron-pages selected="[[routeData.category]]"
        attr-for-selected="name"
        fallback-selection="view404"
        id="pulseContent">

            <gsys-pulse-dashboards name="dashboards" route="[[subroute]]" category="[[routeData.category]]"></gsys-pulse-dashboards>
            <gsys-pulse-templates name="templates" route="[[subroute]]" category="[[routeData.category]]"></gsys-pulse-templates>
            <gsys-pulse-wallboards name="wallboards" route="[[subroute]]" category="[[routeData.category]]"></gsys-pulse-wallboards>

            <gsys-view404 name="view404"></gsys-view404>

      </iron-pages>



  </template>

  <script>
    Polymer({
      is: 'gsys-pulse',

      properties: {

      /*category: Object,
        route: Object,
        routeData: Object,
        visible: Boolean,
        failure: Boolean
      */
      },

      /*switchPages: function() {
        //this.pages = this.$.pulseContent;
        this.$.pulseContent.select(this.routeData.category);
       },

       asyncSwitchPages: function(e) {
        this.async(this.switchPages);
       },


      observers: [
        '_categoryChanged(category, visible)'
      ],


      _computeCategoryName: function(route){
          let urlPath = route.prefix + route.path;
          return urlPath.replace(/\//g,"_").slice(1) || 'pulse-templates';
      },


      _categoryChanged: function(category, visible) {
        if (visible) {
          this.debounce('change-section', function() {
            // Notify the category and the page's title
            this.fire('change-section', {
              category: category.name,
              title: category.title
            });
          });
        }
      },

      _getListItems: function(items) {
        // Return placeholder items when the items haven't loaded yet.
        //return items || [{},{},{},{},{},{},{},{},{},{}];
        return items;
      },

      _getItemHref: function(item) {
        // By returning null when `itemId` is undefined, the href attribute won't be set and
        // the link will be disabled.
        return item.name ? ['/detail', this.category.name, item.name].join('/') : null;
      },

      _refreshGrid: function() {
          this.debounce('refreshGrid', function () {
              console.log('_refreshGrid' + this.$.grid.applyResponsive);
              this.$.grid.applyResponsive(this.$.grid.currentScreenformat, this.$.grid.currentScreenformat);
            }, 100);
          //console.log('_refreshGrid' + this.$.grid.applyResponsive);
          //console.log(this.$.grid.currentScreenformat, this.$.grid.currentScreenformat);
      },

       _pageChanged: function(page) {
        // Load page import on demand. Show 404 page if fails
        var resolvedPageUrl = this.resolveUrl('gsys-' + page + '.html');
        this.importHref(resolvedPageUrl, null, this._showPage404, true);
      },

      _showPage404: function() {
          this.page = 'view404';
      }, */

    });
  </script>
</dom-module>
